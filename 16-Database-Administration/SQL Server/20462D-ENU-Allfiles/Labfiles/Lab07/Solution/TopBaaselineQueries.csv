
                    SELECT YEAR(o.OrderDate) AS OrderYear, MONTH(o.OrderDate) AS OrderMonth,
	                c.Name AS Category, s.Name AS SubCategory, p.Name AS Product,
		            SUM(d.LineTotal) AS Revenue
	                FROM dbo.SalesOrderHeader o JOIN dbo.SalesOrderDetail d
	                ON d.SalesOrderID = o.SalesOrderID
	                JOIN dbo.Product p ON d.ProductID = p.ProductID
	                JOIN dbo.ProductSubcategory s
	                ON p.ProductSubcategoryID = s.ProductSubcategoryID
	                JOIN dbo.ProductCategory c
	                ON s.ProductCategoryID = c.ProductCategoryID
	                GROUP BY YEAR(o.OrderDate), MONTH(o.OrderDate), c.Name, s.Name, p.Name
	                ORDER BY  YEAR(o.OrderDate), MONTH(o.OrderDate), c.Name, s.Name, p.Name;
                  ;,2382,175,2014-07-07 05:53:20.343,1230130,1424266,146759164

                    SELECT c.FirstName + ' ' + c.LastName AS CustomerName, COUNT(d.OrderQty) AS ItemsOrdered
	                FROM dbo.Customer c JOIN dbo.SalesOrderHeader o
                    ON o.CustomerID = c.BusinessEntityID
                    JOIN dbo.SalesOrderDetail d ON d.SalesOrderID = o.SalesOrderID
                    GROUP BY c.FirstName + ' ' + c.LastName
	                ORDER BY ItemsOrdered DESC;
                  ;,1967,234,2014-07-07 05:53:20.270,55429,216315,17907269

                    SELECT cu.CountryRegionName AS CountryRegion, cu.StateProvinceName AS StateProvince,  cu.City,
					YEAR(o.OrderDate) AS OrderYear, MONTH(o.OrderDate) AS OrderMonth,
		            SUM(d.LineTotal) AS Revenue
	                FROM dbo.SalesOrderHeader o JOIN dbo.SalesOrderDetail d
	                ON d.SalesOrderID = o.SalesOrderID
					JOIN Customer cu ON o.CustomerID = cu.BusinessEntityID
	                GROUP BY cu.CountryRegionName, cu.StateProvinceName, cu.City, YEAR(o.OrderDate), MONTH(o.OrderDate)
	                ORDER BY  cu.CountryRegionName, cu.StateProvinceName, cu.City, YEAR(o.OrderDate), MONTH(o.OrderDate);
                  ;,1967,58,2014-07-07 05:53:19.967,234997,234997,9225247

                    SELECT p.Name AS ProductName, COUNT(d.OrderQty) AS OrderCount
	                FROM dbo.Product p JOIN dbo.SalesOrderDetail d
                    ON d.productID = p.ProductID
                    GROUP BY p.Name
	                ORDER BY OrderCount DESC;
                  ;,667,234,2014-07-07 05:53:20.330,11054,26024,2932172
(@_msparam_0 nvarchar(4000),@_msparam_1 nvarchar(4000),@_msparam_2 nvarchar(4000))SELECT
clmns.column_id AS [ID],
clmns.name AS [Name],
clmns.is_nullable AS [Nullable],
CAST(ISNULL(cik.index_column_id, 0) AS bit) AS [InPrimaryKey],
clmns.is_identity AS [Identity],
usrt.name AS [DataType],
ISNULL(baset.name, N'') AS [SystemType],
CAST(CASE WHEN baset.name IN (N'nchar', N'nvarchar') AND clmns.max_length <> -1 THEN clmns.max_length/2 ELSE clmns.max_length END AS int) AS [Length],
CAST(clmns.precision AS int) AS [NumericPrecision],
CAST(clmns.scale AS int) AS [NumericScale],
ISNULL(xscclmns.name, N'') AS [XmlSchemaNamespace],
ISNULL(s2clmns.name, N'') AS [XmlSchemaNamespaceSchema],
ISNULL( (case clmns.is_xml_document when 1 then 2 else 1 end), 0) AS [XmlDocumentConstraint],
s1clmns.name AS [DataTypeSchema]
FROM
sys.all_views AS v
INNER JOIN sys.all_columns AS clmns ON clmns.object_id=v.object_id
LEFT OUTER JOIN sys.indexes AS ik ON ik.object_id = clmns.object_id and 1=ik.is_primary_key
LEFT OUTER JOIN sys.index_columns AS cik ON cik.index_id = ik.index_id and cik.column_id = clmns.column_id and cik.object_id = clmns.object_id and 0 = cik.is_included_column
LEFT OUTER JOIN sys.types AS usrt ON usrt.user_type_id = clmns.user_type_id
LEFT OUTER JOIN sys.types AS baset ON (baset.user_type_id = clmns.system_type_id and baset.user_type_id = baset.system_type_id) or ((baset.system_type_id = clmns.system_type_id) and (baset.user_type_id = clmns.user_type_id) and (baset.is_user_defined = 0) and (baset.is_assembly_type = 1)) 
LEFT OUTER JOIN sys.xml_schema_collections AS xscclmns ON xscclmns.xml_collection_id = clmns.xml_collection_id
LEFT OUTER JOIN sys.schemas AS s2clmns ON s2clmns.schema_id = xscclmns.schema_id
LEFT OUTER JOIN sys.schemas AS s1clmns ON s1clmns.schema_id = usrt.schema_id
WHERE
(v.type = @_msparam_0)and(v.name=@_msparam_1 and SCHEMA_NAME(v.schema_id)=@_msparam_2)
ORDER BY
[ID] ASC,649,2,2014-07-07 06:08:49.787,1157,1637,2795
